const emojis = ['üòÄ', 'üòé', 'üëæ', 'üê±', 'üê∂', 'üçï', 'üöÄ', 'üéâ', '‚ú®'];
let score = 0;
let classType = null;
let clickPower = 1; // –ë–∞–∑–æ–≤–∞—è —Å–∏–ª–∞ –∫–ª–∏–∫–æ–≤
let bonusChance = 0.1; // –ë–∞–∑–æ–≤—ã–π —à–∞–Ω—Å –Ω–∞ –±–æ–Ω—É—Å
let emojiSpawnRate = 2000; // –ò–Ω—Ç–µ—Ä–≤–∞–ª –ø–æ—è–≤–ª–µ–Ω–∏—è —ç–º–æ–¥–∑–∏ (–≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö)

// –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ localStorage
function loadProgress() {
  const savedScore = localStorage.getItem('score');
  const savedClass = localStorage.getItem('classType');

  if (savedScore) {
    score = parseInt(savedScore, 10); // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ—á–∫–∏
  }

  if (savedClass) {
    classType = savedClass; // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–ª–∞—Å—Å
    startGame(classType); // –ó–∞–ø—É—Å–∫–∞–µ–º –∏–≥—Ä—É —Å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º –∫–ª–∞—Å—Å–æ–º
  }
}

// –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ localStorage
function saveProgress() {
  localStorage.setItem('score', score);
  if (classType) {
    localStorage.setItem('classType', classType);
  }
}

// –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—á–µ—Ç–∞ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
function updateScoreDisplay() {
  document.getElementById('score').textContent = `Score: ${score}`;
  saveProgress(); // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
}

// –ù–∞—á–∞–ª–æ –∏–≥—Ä—ã –ø–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ –∫–ª–∞—Å—Å–∞
document.querySelectorAll('.class-button').forEach(button => {
  button.addEventListener('click', () => {
    classType = button.dataset.class;
    saveProgress(); // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–±–æ—Ä –∫–ª–∞—Å—Å–∞
    startGame(classType);
  });
});

function startGame(selectedClass) {
  // –°–∫—Ä—ã–≤–∞–µ–º –≤—ã–±–æ—Ä –∫–ª–∞—Å—Å–∞ –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–≥—Ä–æ–≤–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
  document.getElementById('class-selection').style.display = 'none';
  document.getElementById('game-container').style.display = 'block';
  document.getElementById('listing-button').style.display = 'block';
  document.getElementById('reset-button').style.display = 'block';

  // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–æ–Ω—É—Å–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∞
  if (selectedClass === 'warrior') {
    clickPower = 2; // –£ –≤–æ–∏–Ω–æ–≤ —É–¥–≤–æ–µ–Ω–Ω–∞—è —Å–∏–ª–∞ –∫–ª–∏–∫–æ–≤
  } else if (selectedClass === 'mage') {
    clickPower = 1;
    score += 10; // –ú–∞–≥–∏ –Ω–∞—á–∏–Ω–∞—é—Ç —Å –±–æ–Ω—É—Å–æ–º –æ—á–∫–æ–≤
  } else if (selectedClass === 'rogue') {
    bonusChance = 0.2; // –†–∞–∑–±–æ–π–Ω–∏–∫–∏ –ø–æ–ª—É—á–∞—é—Ç –ø–æ–≤—ã—à–µ–Ω–Ω—ã–π —à–∞–Ω—Å –Ω–∞ –±–æ–Ω—É—Å–Ω—ã–µ —ç–º–æ–¥–∑–∏
  }

  updateScoreDisplay(); // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—á–µ—Ç–∞

  // –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã ‚Äî –ø–æ—è–≤–ª–µ–Ω–∏–µ —ç–º–æ–¥–∑–∏
  setInterval(createEmoji, emojiSpawnRate);
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–ª—É—á–∞–π–Ω–æ–≥–æ —ç–º–æ–¥–∑–∏
function createEmoji() {
  const emojiDiv = document.createElement('div');
  emojiDiv.classList.add('emoji');
  let randomEmoji = emojis[Math.floor(Math.random() * emojis.length)];

  emojiDiv.textContent = randomEmoji;
  emojiDiv.style.left = Math.random() * 90 + 'vw'; // –°–ª—É—á–∞–π–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ –ø–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∏
  emojiDiv.style.top = Math.random() * 50 + 'vh';  // –°–ª—É—á–∞–π–Ω–æ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏

  // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–∞ –ø–æ —ç–º–æ–¥–∑–∏
  emojiDiv.addEventListener('click', () => {
    emojiDiv.remove();
    let points = clickPower;

    // –®–∞–Ω—Å –Ω–∞ –±–æ–Ω—É—Å–Ω—ã–µ –æ—á–∫–∏ (–¥–ª—è —Ä–∞–∑–±–æ–π–Ω–∏–∫–∞ –∏–ª–∏ –º–∞–≥–∏—á–µ—Å–∫–æ–≥–æ —ç–º–æ–¥–∑–∏)
    if (Math.random() < bonusChance && randomEmoji === '‚ú®') {
      points *= 2;
    }

    score += points;
    updateScoreDisplay(); // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
  });

  document.querySelector('#emoji-container').appendChild(emojiDiv);
}

// –ê–ø–≥—Ä–µ–π–¥—ã –∑–∞ –æ—á–∫–∏
document.querySelectorAll('.upgrade-button').forEach(button => {
  button.addEventListener('click', () => {
    if (score >= 10) { // –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –∞–ø–≥—Ä–µ–π–¥–∞ ‚Äî 10 –æ—á–∫–æ–≤
      score -= 10;

      if (button.dataset.upgrade === 'increase-click-power') {
        clickPower++;
      } else if (button.dataset.upgrade === 'faster-emojis') {
        emojiSpawnRate = Math.max(emojiSpawnRate - 200, 500); // –£—Å–∫–æ—Ä–µ–Ω–∏–µ –ø–æ—è–≤–ª–µ–Ω–∏—è —ç–º–æ–¥–∑–∏
      } else if (button.dataset.upgrade === 'bonus-chance') {
        bonusChance = Math.min(bonusChance + 0.05, 0.5); // –£–≤–µ–ª–∏—á–µ–Ω–∏–µ —à–∞–Ω—Å–∞ –Ω–∞ –±–æ–Ω—É—Å
      }

      updateScoreDisplay(); // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
    }
  });
});

// –ö–Ω–æ–ø–∫–∞ –¥–ª—è —Å–±—Ä–æ—Å–∞ —Å—á–µ—Ç–∞
document.getElementById('reset-button').addEventListener('click', () => {
  score = 0;
  updateScoreDisplay(); // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ–º
});

// –ö–Ω–æ–ø–∫–∞ –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –ª–∏—Å—Ç–∏–Ω–≥–∞
document.getElementById('listing-button').addEventListener('click', () => {
  window.location.href = 'listing.html';
});

// –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
document.addEventListener('DOMContentLoaded', () => {
  loadProgress(); // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
});
